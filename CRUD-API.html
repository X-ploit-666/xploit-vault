<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mastering CRUD APIs</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700;900&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #F0F9FF; /* Lightest Blue background */
            color: #1E3A8A; /* Dark Blue text */
        }
        
        /* Chart Container Standards */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Constraint */
            margin-left: auto;
            margin-right: auto;
            height: 350px; /* Base height */
            max-height: 400px;
        }

        /* Responsive height adjustments */
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        /* Flowchart Connector Lines via CSS Borders - NO SVG */
        .flow-line-vertical {
            width: 2px;
            background-color: #2563EB;
            height: 40px;
            margin: 0 auto;
        }
        
        .flow-line-horizontal {
            height: 2px;
            background-color: #2563EB;
            width: 100%;
            position: absolute;
            top: 50%;
            z-index: 0;
        }

        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(37, 99, 235, 0.1), 0 2px 4px -1px rgba(37, 99, 235, 0.06);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #EFF6FF;
        }
        ::-webkit-scrollbar-thumb {
            background: #3B82F6;
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #2563EB;
        }
    </style>
    <!-- 
        Palette: Brilliant Blues
        Primary: #2563EB (Blue 600)
        Secondary: #60A5FA (Blue 400)
        Dark: #1E3A8A (Blue 900)
        Light: #EFF6FF (Blue 50)
        Accent: #3B82F6 (Blue 500)
    -->
    <!-- 
        Source Material Analysis:
        - Topic: CRUD API Interaction
        - Key Data: 4 Operations (Create, Read, Update, Delete), 4 Methods (POST, GET, PUT, DELETE), Tools (curl, jq).
        - Narrative: Intro -> Concept -> Mapping -> Syntax -> Flow -> Conclusion.
        - Visuals: Doughnut (CRUD Concept), Bar (Method Freq), HTML Flowchart (Cycle), Styled Cards (Tools).
    -->
</head>
<body class="bg-blue-50 text-slate-800">

    <!-- Navigation/Header -->
    <nav class="sticky top-0 z-50 bg-blue-700 shadow-lg text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="text-2xl font-black tracking-widest">CRUD<span class="text-blue-300">MASTER</span></span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#concept" class="hover:bg-blue-600 px-3 py-2 rounded-md text-sm font-medium">Concept</a>
                        <a href="#mapping" class="hover:bg-blue-600 px-3 py-2 rounded-md text-sm font-medium">Methods</a>
                        <a href="#flow" class="hover:bg-blue-600 px-3 py-2 rounded-md text-sm font-medium">Cycle</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Grid -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-16">

        <!-- Section 1: Introduction / Hook -->
        <section id="concept" class="text-center space-y-6">
            <h1 class="text-4xl md:text-5xl font-extrabold text-blue-900">Understanding CRUD APIs</h1>
            <p class="text-xl text-blue-700 max-w-3xl mx-auto leading-relaxed">
                An <strong>API</strong> (Application Programming Interface) is the waiter of the digital world. You don't go into the kitchen (Database) yourself; you tell the waiter what you want, and they bring you the result.
            </p>
            
            <!-- Analogy Visual using Cards & Icons (No SVG) -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-10">
                <!-- Client -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-blue-500">
                    <div class="text-6xl mb-4">üë§</div>
                    <h3 class="text-xl font-bold text-blue-900">You (Client)</h3>
                    <p class="text-gray-600 mt-2">Make a Request (Order food)</p>
                </div>
                <!-- API -->
                <div class="bg-blue-600 p-6 rounded-xl card-shadow text-white transform scale-105">
                    <div class="text-6xl mb-4">üíÅ‚ôÇ</div>
                    <h3 class="text-xl font-bold">API (Waiter)</h3>
                    <p class="text-blue-100 mt-2">Takes Order & Delivers Food</p>
                </div>
                <!-- Database -->
                <div class="bg-white p-6 rounded-xl card-shadow border-t-4 border-blue-500">
                    <div class="text-6xl mb-4">üíæ</div>
                    <h3 class="text-xl font-bold text-blue-900">Database (Kitchen)</h3>
                    <p class="text-gray-600 mt-2">Prepares & Stores Data</p>
                </div>
            </div>
        </section>

        <!-- Section 2: The 4 Core Operations (Visualization) -->
        <section id="crud-chart-section" class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <div class="space-y-4">
                <div class="border-l-4 border-blue-600 pl-4">
                    <h2 class="text-3xl font-bold text-blue-900">The CRUD Model</h2>
                </div>
                <p class="text-gray-700 leading-relaxed">
                    Most APIs follow the <strong>CRUD</strong> model, representing the four fundamental actions you can perform on persistent data. This model ensures that applications can handle data lifecycles completely.
                </p>
                <ul class="space-y-3 mt-4">
                    <li class="flex items-center"><span class="bg-green-100 text-green-800 font-bold px-2 py-1 rounded mr-3">C</span> Create: Add new items</li>
                    <li class="flex items-center"><span class="bg-blue-100 text-blue-800 font-bold px-2 py-1 rounded mr-3">R</span> Read: View existing items</li>
                    <li class="flex items-center"><span class="bg-yellow-100 text-yellow-800 font-bold px-2 py-1 rounded mr-3">U</span> Update: Modify items</li>
                    <li class="flex items-center"><span class="bg-red-100 text-red-800 font-bold px-2 py-1 rounded mr-3">D</span> Delete: Remove items</li>
                </ul>
            </div>
            
            <!-- Chart Container -->
            <div class="bg-white p-4 rounded-xl shadow-lg">
                <div class="chart-container">
                    <canvas id="crudDoughnutChart"></canvas>
                </div>
                <p class="text-center text-sm text-gray-500 mt-2 italic">Figure 1: The Four Pillars of Data Interaction</p>
            </div>
        </section>

        <!-- Section 3: HTTP Method Mapping (Comparison) -->
        <section id="mapping" class="bg-white rounded-2xl shadow-xl overflow-hidden">
            <div class="bg-blue-800 p-6">
                <h2 class="text-3xl font-bold text-white">Mapping Operations to Methods</h2>
                <p class="text-blue-200 mt-2">To communicate your intent to the API, you must use the correct HTTP Verb.</p>
            </div>
            
            <div class="p-8 grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Bar Chart: Method Usage Frequency (Conceptual) -->
                <div>
                    <h3 class="text-xl font-bold text-blue-900 mb-4">Interaction Volume by Method</h3>
                    <p class="text-gray-600 text-sm mb-6">
                        While all methods are critical, <strong>GET (Read)</strong> requests typically make up the majority of web traffic, as users view data far more often than they modify it.
                    </p>
                    <div class="chart-container">
                        <canvas id="methodBarChart"></canvas>
                    </div>
                </div>

                <!-- Mapping Table/Grid -->
                <div class="space-y-6">
                    <h3 class="text-xl font-bold text-blue-900 mb-4">The Protocol Translation</h3>
                    <div class="grid grid-cols-1 gap-4">
                        <!-- Create -->
                        <div class="flex items-center justify-between p-4 bg-green-50 border-l-4 border-green-500 rounded-r-lg">
                            <div>
                                <span class="block text-lg font-bold text-green-900">Create</span>
                                <span class="text-sm text-green-700">"Add this new item"</span>
                            </div>
                            <div class="bg-green-600 text-white font-mono px-4 py-2 rounded font-bold">POST</div>
                        </div>
                        <!-- Read -->
                        <div class="flex items-center justify-between p-4 bg-blue-50 border-l-4 border-blue-500 rounded-r-lg">
                            <div>
                                <span class="block text-lg font-bold text-blue-900">Read</span>
                                <span class="text-sm text-blue-700">"Show me the list"</span>
                            </div>
                            <div class="bg-blue-600 text-white font-mono px-4 py-2 rounded font-bold">GET</div>
                        </div>
                        <!-- Update -->
                        <div class="flex items-center justify-between p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded-r-lg">
                            <div>
                                <span class="block text-lg font-bold text-yellow-900">Update</span>
                                <span class="text-sm text-yellow-700">"Change this item"</span>
                            </div>
                            <div class="bg-yellow-600 text-white font-mono px-4 py-2 rounded font-bold">PUT / PATCH</div>
                        </div>
                        <!-- Delete -->
                        <div class="flex items-center justify-between p-4 bg-red-50 border-l-4 border-red-500 rounded-r-lg">
                            <div>
                                <span class="block text-lg font-bold text-red-900">Delete</span>
                                <span class="text-sm text-red-700">"Get rid of this"</span>
                            </div>
                            <div class="bg-red-600 text-white font-mono px-4 py-2 rounded font-bold">DELETE</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 4: Tooling & Syntax -->
        <section class="space-y-6">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-blue-900">Tools of the Trade</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">Mastering APIs requires command-line proficiency. We use <code class="bg-gray-200 px-1 rounded text-blue-700">curl</code> to talk to the API and <code class="bg-gray-200 px-1 rounded text-blue-700">jq</code> to format the JSON response.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Anatomy of a Request -->
                <div class="bg-slate-900 rounded-xl p-6 text-white font-mono shadow-2xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-blue-600 px-3 py-1 text-xs font-bold uppercase tracking-wider">Update (PUT) Example</div>
                    <p class="text-gray-400 mb-2"># Updating a city record</p>
                    <div class="space-y-2">
                        <p><span class="text-green-400">curl</span> <span class="text-yellow-400">-X PUT</span> \</p>
                        <p class="pl-4"><span class="text-yellow-400">-d</span> <span class="text-orange-300">'{"city":"New_Name"}'</span> \</p>
                        <p class="pl-4"><span class="text-yellow-400">-H</span> <span class="text-orange-300">'Content-Type: application/json'</span> \</p>
                        <p class="pl-4 text-blue-300">http://api.htb/city/london</p>
                    </div>
                    <div class="mt-6 border-t border-slate-700 pt-4 text-sm text-slate-400">
                        <p><strong class="text-white">-X:</strong> Specifies the Method (PUT)</p>
                        <p><strong class="text-white">-d:</strong> The Data payload (JSON)</p>
                        <p><strong class="text-white">-H:</strong> Headers (Defining content type)</p>
                    </div>
                </div>

                <!-- Anatomy of a Response -->
                <div class="bg-slate-900 rounded-xl p-6 text-white font-mono shadow-2xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 bg-green-600 px-3 py-1 text-xs font-bold uppercase tracking-wider">Read (GET) Response</div>
                    <p class="text-gray-400 mb-2"># Piped through | jq</p>
                    <div class="text-green-300">
                        [<br>
                        &nbsp;&nbsp;{<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-blue-300">"city_name"</span>: <span class="text-orange-300">"London"</span>,<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-blue-300">"country"</span>: <span class="text-orange-300">"UK"</span><br>
                        &nbsp;&nbsp;}<br>
                        ]
                    </div>
                    <div class="mt-6 border-t border-slate-700 pt-4 text-sm text-slate-400">
                        <p><strong class="text-white">JSON:</strong> The "Universal Language" of APIs.</p>
                        <p><strong class="text-white">[]:</strong> Arrays (Lists of items).</p>
                        <p><strong class="text-white">{}:</strong> Objects (Key-value pairs).</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 5: The Interaction Flowchart -->
        <section id="flow" class="py-10">
            <h2 class="text-3xl font-bold text-center text-blue-900 mb-12">The Request-Response Cycle</h2>
            
            <!-- Custom CSS Grid Flowchart (No Mermaid/SVG) -->
            <div class="relative max-w-4xl mx-auto">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center relative z-10">
                    
                    <!-- Step 1 -->
                    <div class="bg-white p-6 rounded-lg shadow-lg border-2 border-blue-100 flex flex-col items-center">
                        <div class="bg-blue-100 p-3 rounded-full mb-3 text-2xl">üíª</div>
                        <h4 class="font-bold text-lg">1. The Trigger</h4>
                        <p class="text-sm text-gray-600 mt-2">Hacker runs <code>curl</code> command requesting data.</p>
                    </div>

                    <!-- Step 2 -->
                    <div class="bg-blue-600 p-6 rounded-lg shadow-lg text-white flex flex-col items-center transform md:-translate-y-4">
                        <div class="bg-blue-500 p-3 rounded-full mb-3 text-2xl">‚ö°</div>
                        <h4 class="font-bold text-lg">2. The API</h4>
                        <p class="text-sm text-blue-100 mt-2">Receives HTTP Method (GET/POST) & processes logic.</p>
                    </div>

                    <!-- Step 3 -->
                    <div class="bg-white p-6 rounded-lg shadow-lg border-2 border-blue-100 flex flex-col items-center">
                        <div class="bg-green-100 p-3 rounded-full mb-3 text-2xl">üíæ</div>
                        <h4 class="font-bold text-lg">3. The Data</h4>
                        <p class="text-sm text-gray-600 mt-2">Database Creates, Reads, Updates, or Deletes records.</p>
                    </div>
                </div>

                <!-- Connectors (Desktop Only) -->
                <div class="hidden md:block absolute top-1/2 left-0 w-full h-2 z-0 transform -translate-y-6">
                    <div class="h-1 bg-blue-200 w-full rounded"></div>
                    <!-- Arrowheads using text -->
                    <div class="absolute right-1/3 top-0 transform -translate-y-2 text-blue-400 text-2xl">‚û§</div>
                    <div class="absolute right-0 top-0 transform -translate-y-2 text-blue-400 text-2xl">‚û§</div>
                </div>

                <!-- Return Cycle -->
                 <div class="mt-8 bg-blue-50 rounded-lg p-4 border border-blue-200 text-center">
                    <span class="text-2xl font-bold text-blue-500 mr-2">‚Ü∫</span>
                    <span class="font-medium text-blue-800">The Cycle Completes:</span> 
                    <span class="text-gray-600">The Database confirms success, the API formats it as JSON, and the Client receives the response.</span>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="border-t border-blue-200 pt-8 pb-10 text-center text-blue-800">
            <p class="font-bold text-lg">Mastering CRUD APIs</p>
            <p class="text-sm mt-2 opacity-75">Visualized for modern developers.</p>
        </footer>

    </main>

    <!-- Scripts for Chart.js -->
    <script>
        // --- 1. Label Wrapping Helper Function (Mandatory) ---
        function formatLabel(str, maxwidth) {
            var sections = [];
            var words = str.split(" ");
            var temp = "";
            words.forEach(function(item, index) {
                if (temp.length > 0) {
                    var concat = temp + ' ' + item;
                    if (concat.length > maxwidth) {
                        sections.push(temp);
                        temp = "";
                    } else {
                        if (index == (words.length - 1)) {
                            sections.push(concat);
                            return;
                        } else {
                            temp = concat;
                            return;
                        }
                    }
                }
                if (index == (words.length - 1)) {
                    sections.push(item);
                    return;
                }
                if (item.length < maxwidth) {
                    temp = item;
                } else {
                    sections.push(item);
                }
            });
            return sections;
        }

        // --- 2. Tooltip Configuration (Mandatory) ---
        const commonTooltipOptions = {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    if (Array.isArray(label)) {
                        return label.join(' ');
                    } else {
                        return label;
                    }
                }
            }
        };

        // --- 3. Chart 1: CRUD Doughnut Chart ---
        const ctxCrud = document.getElementById('crudDoughnutChart').getContext('2d');
        const crudLabels = ["Create (POST)", "Read (GET)", "Update (PUT/PATCH)", "Delete (DELETE)"];
        // Apply label wrapping
        const processedCrudLabels = crudLabels.map(l => formatLabel(l, 16));

        new Chart(ctxCrud, {
            type: 'doughnut',
            data: {
                labels: processedCrudLabels,
                datasets: [{
                    data: [25, 25, 25, 25], // Conceptual equality
                    backgroundColor: [
                        '#166534', // Green (Create)
                        '#1E40AF', // Blue (Read)
                        '#CA8A04', // Yellow (Update)
                        '#991B1B'  // Red (Delete)
                    ],
                    borderWidth: 0,
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { font: { family: "'Roboto', sans-serif" } }
                    },
                    tooltip: commonTooltipOptions
                }
            }
        });

        // --- 4. Chart 2: Method Frequency Bar Chart ---
        const ctxMethod = document.getElementById('methodBarChart').getContext('2d');
        const methodLabels = ["Read (GET)", "Create (POST)", "Update (PUT)", "Delete (DELETE)"];
        // Apply label wrapping
        const processedMethodLabels = methodLabels.map(l => formatLabel(l, 16));

        new Chart(ctxMethod, {
            type: 'bar',
            data: {
                labels: processedMethodLabels,
                datasets: [{
                    label: 'Relative Usage Frequency',
                    data: [65, 20, 10, 5], // Mock data representing typical read-heavy apps
                    backgroundColor: [
                        '#3B82F6', // Blue 500
                        '#60A5FA', // Blue 400
                        '#93C5FD', // Blue 300
                        '#BFDBFE'  // Blue 200
                    ],
                    borderRadius: 6
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                indexAxis: 'y', // Horizontal Bar Chart
                plugins: {
                    legend: { display: false },
                    tooltip: commonTooltipOptions
                },
                scales: {
                    x: {
                        grid: { display: false },
                        ticks: { display: false } // Hide numbers to keep it conceptual
                    },
                    y: {
                        grid: { display: false },
                        ticks: { font: { family: "'Roboto', sans-serif", weight: 'bold' } }
                    }
                }
            }
        });
    </script>
</body>
</html>
